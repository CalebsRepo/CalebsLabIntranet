
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=1,initial-scale=1,user-scalable=no" />
    <title>CMS(Caleb's lab Management System)</title>
    <script src="../js/common.js"></script>

    <link href="../css/jquery.mobile-1.4.5.css" rel="stylesheet">
    <link href="../css/bootstrap.min.css" rel='stylesheet'  />
    <link href='../css/fullcalendar.min.css' rel='stylesheet' />
    <link href='../css/fullcalendar.print.min.css' rel='stylesheet' media='print' />

    <script src="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
    <script src='../js/fullcalendar/moment.min.js'></script>
    <script src='../js/fullcalendar/fullcalendar.min.js'></script>
    <script src="../js/fullcalendar/ko.js"></script>
    <script src="../js/bootstrap.min.js"></script>


    <script type="text/javascript">

       var eventsArr = [];
       var colorArr = ['51bec9', '24afd6', 'ffaf51', 'fd8497', 'f7d17c', '51d5a1', '21b4aa', 'aed551', 'f9916a', '99837a'];
       var cnt = 0;
       $(document).ready(function() {

          navigate({}, "calander.json", successFunction, errorFunction);

      }); // end of $(document).ready()------------------------

      function successFunction(data) {
            for(var i=0; i<data.length; i++) {

                    var titleVal = data[i].name ;
                    var descriptionVal = data[i].h_flag + " " + data[i].apply_count + "일";

                    var startday = data[i].start_ymd;
                    startday = startday.substring(0,4) + "-" + startday.substring(4,6) + "-" + startday.substring(6,8);

                    var endday = data[i].end_ymd;
                    endday = endday.substring(0,4) + "-" + endday.substring(4,6) + "-" + endday.substring(6,8);
                    // 날짜 하루 더해주기
                    var addEndday = dayAdd(endday);
                    var colorVal = "#"+colorArr[cnt ++];

                    if(cnt > 9){
                        cnt = 0;
                    }

                    var str  = 	{
                                 title: titleVal,
                                 description: descriptionVal,
                                 start: startday,
                                 end: addEndday,
                                 color: colorVal
                                }
                    eventsArr.push(str);

             }// end of for ------------------------------------------------
             CalendarLoad();
      }

      function errorFunction(result) {
        alert("error>>>"+result);
      }

      function CalendarLoad() {

            $("#calendar").fullCalendar({
                header: {
                //	left: 'prevYear'
                    left: 'prevYear prev',
                    center: 'title',
                    right: 'next nextYear'
                },

                defaultDate:  getToday(),// 오늘 날짜를 불러오는 함수
                buttonIcons: true, // show the prev/next text
                weekNumbers: false,
                editable: false,
                lang:'ko',
                events:  eventsArr
                      /* [

                    {
                        id:'0',
                        title: '<img src="/images/is/flag/11101_s.gif" style="width:15px;height:11px"> 파리',
                        start: '2019-02-21',
                        end: '2019-03-01',

                        color: '#51bec9'
                    },

                    {
                        id:'1',
                        title: '<img src="/images/is/flag/13103_s.gif" style="width:15px;height:11px"> 바르샤바',
                        start: '2019-02-24',
                        end: '2019-02-26',

                        color: '#24afd6'
                    },

                    {
                        title: '출국일',
                        start: '2019-02-21',
                        end: '2019-02-29',
                        color: '#999999'

                    }
                ]  */ ,
                height: 450,
                eventRender: function (event, element) {
                    element.find('.fc-content').html(event.title);
                    element.popover({
                          title: event.title,
                          content: event.description,
                          trigger: 'hover',
                          placement: 'bottom',
                          container: 'body'
                    });
                }

            }); // end of $("#calendar").fullCalendar()--------------------------------------

      } // end of CalendarLoad() --------------------------------------------

      // 날짜를 하루 더하는 함수
      function dayAdd(pdate){

          // console.log("pdate : " + pdate);
          var arr = pdate.split('-');
          var date = new Date(arr[0], arr[1]-1, arr[2]);
          date.setDate(date.getDate()+1);

          var year = date.getFullYear();
          var month = new String(date.getMonth()+1);
          var day = new String(date.getDate());

          // 한자리수일 경우 0을 채워준다.
          if(month.length == 1){
            month = "0" + month;
          }
          if(day.length == 1){
            day = "0" + day;
          }
          return year + "-" + month + "-" + day;

      }
      // 오늘 날짜를 알아오는 함수
      function getToday(){

          var date = new Date();

          var year = date.getFullYear();
          var month = new String(date.getMonth()+1);
          var day = new String(date.getDate());

          // 한자리수일 경우 0을 채워준다.
          if(month.length == 1){
            month = "0" + month;
          }
          if(day.length == 1){
            day = "0" + day;
          }
          return year + "-" + month + "-" + day;

      }

    </script>


    <style type="text/css">
        .ui-btn-icon-top { padding-top : 3em;}
        .ui-bar { text-align: center; }
        .ui-bar .header-menu { float: right; }
        .ui-bar .header-back { float: left; }
        .ui-panel { width : 20em;}
        #menuPanel p { margin: 0; padding: 10px 0 5px 5px; }

        }


    </style>

</head>
<body>

<header data-role="header">
    <div class="ui-bar">
        <button class="header-back"><span>back</span></button>
        <h1>CalebsLab</h1>
        <a href="#menuPanel" class="btn header-menu">Menu</a>
    </div>
</header>
<div data-role="panel" id="menuPanel" data-position="right" data-display="overlay" data-theme="a">
    <h2>메뉴</h2>
    <ul data-role="listview">
        <p>내정보</p>
        <li><a href="#">마이페이지</a></li>
        <p>프로젝트</p>
        <li><a href="#">프로젝트</a></li>
        <li><a href="#">프로젝트일정 목록</a></li>
        <p>휴가</p>
        <li><a href="#">휴가신청</a></li>
        <li><a href="#">휴가신청내역</a></li>
        <li><a href="#">휴가캘린더</a></li>
        <p>게시판</p>
        <li><a href="#">FAQ</a></li>
        <p>관리</p>
        <li><a href="#">사원등록</a></li>
        <li><a href="#">사원목록</a></li>
        <li><a  onclick="movePage('main.html')">휴가현황</a></li>
    </ul>
</div>

<section class="container">
<div id="calendar" style="border: 0px solid  blue; padding-top:50px;"></div>
</section>

<!-- footer -->
<div style="overflow: hidden;" data-role="footer" data-position="fixed">
    <div data-role="navbar">
        <ul>
            <li><a href="#" data-icon="home">홈</a></li>
            <li><a href="#" data-icon="shop">프로젝트</a></li>
            <li><a href="#" data-icon="calendar">휴가신청</a></li>
            <li><a href="#" data-icon="power">로그아웃</a></li>
        </ul>
    </div>
</div>

</body>
</html>